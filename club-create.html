<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Club - StickerHunt</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">

    <!-- SEO Meta Tags -->
    <meta name="description" content="Create new football clubs in the StickerHunt database.">
    <meta name="robots" content="noindex, nofollow">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://stickerhunt.club/club-create.html">
    <meta property="og:title" content="Create Club - StickerHunt">
    <meta property="og:image" content="https://stickerhunt.club/metash.png">
    <meta property="og:site_name" content="StickerHunt">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">

    <style>
        .create-form {
            max-width: 600px;
            margin: 0 auto;
            text-align: left;
        }

        .form-group {
            margin-bottom: calc(var(--spacing-unit) * 2.5);
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: var(--spacing-unit);
            color: var(--color-text);
        }

        .form-group input[type="text"],
        .form-group input[type="url"],
        .form-group textarea {
            width: 100%;
            padding: calc(var(--spacing-unit) * 1.5);
            font-size: 1em;
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            margin: 0;
            box-sizing: border-box;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
            font-family: inherit;
        }

        .form-group small {
            display: block;
            margin-top: calc(var(--spacing-unit) * 0.5);
            color: var(--color-info-text);
            font-size: 0.85em;
        }

        .club-autocomplete {
            position: relative;
        }

        .suggestions-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--color-background);
            border: 1px solid var(--color-border);
            border-top: none;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .suggestions-list.visible {
            display: block;
        }

        .suggestion-item {
            padding: calc(var(--spacing-unit) * 1.5);
            cursor: pointer;
            border-bottom: 1px solid var(--color-border);
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item:hover,
        .suggestion-item.selected {
            background-color: var(--color-accent);
            color: var(--color-accent-text);
        }

        .suggestion-country {
            font-size: 0.85em;
            color: var(--color-info-text);
            margin-left: var(--spacing-unit);
        }

        .suggestion-item:hover .suggestion-country,
        .suggestion-item.selected .suggestion-country {
            color: var(--color-accent-text);
            opacity: 0.8;
        }

        .submit-btn {
            width: 100%;
            padding: calc(var(--spacing-unit) * 2);
            font-size: 1.1em;
            font-weight: 600;
            margin-top: calc(var(--spacing-unit) * 2);
        }

        .status-message {
            margin-top: calc(var(--spacing-unit) * 2);
            padding: calc(var(--spacing-unit) * 2);
            border-radius: var(--border-radius);
            text-align: left;
        }

        .status-message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .status-message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-message.error {
            background: var(--color-error-bg);
            color: var(--color-error);
            border: 1px solid #f5c6cb;
        }

        .status-message a {
            color: inherit;
            font-weight: 600;
        }

        .access-denied {
            text-align: center;
            padding: calc(var(--spacing-unit) * 4);
        }

        .access-denied h2 {
            color: var(--color-error);
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        .loading-state {
            text-align: center;
            padding: calc(var(--spacing-unit) * 4);
            color: var(--color-info-text);
        }

        .progress-log {
            background: var(--color-secondary-bg);
            border-radius: var(--border-radius);
            padding: calc(var(--spacing-unit) * 2);
            margin-top: calc(var(--spacing-unit) * 2);
            font-family: monospace;
            font-size: 0.9em;
            max-height: 300px;
            overflow-y: auto;
        }

        .progress-log .log-entry {
            margin: calc(var(--spacing-unit) * 0.5) 0;
            padding: calc(var(--spacing-unit) * 0.5) 0;
            border-bottom: 1px solid var(--color-border);
        }

        .progress-log .log-entry:last-child {
            border-bottom: none;
        }

        .progress-log .log-success {
            color: var(--color-success);
        }

        .progress-log .log-error {
            color: var(--color-error);
        }

        .progress-log .log-info {
            color: var(--color-info-text);
        }

        .result-card {
            background: var(--color-secondary-bg);
            border-radius: var(--border-radius);
            padding: calc(var(--spacing-unit) * 2);
            margin-top: calc(var(--spacing-unit) * 2);
        }

        .result-card h3 {
            margin-top: 0;
            margin-bottom: var(--spacing-unit);
        }

        .result-card .result-row {
            display: flex;
            padding: calc(var(--spacing-unit) * 0.5) 0;
            border-bottom: 1px solid var(--color-border);
        }

        .result-card .result-row:last-child {
            border-bottom: none;
        }

        .result-card .result-label {
            font-weight: 600;
            min-width: 100px;
            color: var(--color-info-text);
        }

        .result-card .result-value {
            flex: 1;
            word-break: break-word;
        }

        .result-actions {
            display: flex;
            gap: var(--spacing-unit);
            margin-top: calc(var(--spacing-unit) * 2);
            flex-wrap: wrap;
        }

        .result-actions .btn {
            flex: 1;
            min-width: 150px;
        }

        .enrichment-toggle {
            display: flex;
            align-items: center;
            gap: var(--spacing-unit);
            margin-bottom: calc(var(--spacing-unit) * 2);
            padding: calc(var(--spacing-unit) * 1.5);
            background: var(--color-secondary-bg);
            border-radius: var(--border-radius);
        }

        .enrichment-toggle input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .enrichment-toggle label {
            margin: 0;
            font-weight: 500;
            cursor: pointer;
        }

        .enrichment-toggle small {
            margin-left: auto;
            color: var(--color-info-text);
        }

        .country-code-input {
            text-transform: uppercase;
        }
    </style>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4Y0MJKGDZS"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-4Y0MJKGDZS');
    </script>
    <!-- Amplitude Analytics -->
    <script src="https://cdn.amplitude.com/script/678e88d5fa8972f1fe39b2cd59ef456.js"></script>
    <script>window.amplitude.add(window.sessionReplay.plugin({sampleRate: 1}));window.amplitude.init('678e88d5fa8972f1fe39b2cd59ef456', {"fetchRemoteConfig":true,"autocapture":{"attribution":true,"fileDownloads":true,"formInteractions":true,"pageViews":true,"sessions":true,"elementInteractions":true,"networkTracking":true,"webVitals":true,"frustrationInteractions":true}});</script>

</head>
<body>
    <header class="app-header">
        <div class="logo-container">
           <a href="/index.html"><img src="/logo.png" alt="StickerHunt Logo" id="app-logo"></a>
        </div>
        <div id="auth-section">
             <button id="login-button" class="btn btn-primary google-login" style="display: none;">
                 <span>Sign in with Google</span>
             </button>
             <div id="user-status" style="display: none;">
                 <strong id="user-nickname" title="Click to edit nickname">Loading...</strong>
                 <button id="logout-button" class="btn-link">Logout</button>
             </div>
         </div>
    </header>

    <main class="container">
        <h1>Create Club</h1>

        <!-- Loading state -->
        <div id="loading-state" class="loading-state">
            <p>Checking permissions...</p>
        </div>

        <!-- Access denied -->
        <div id="access-denied" class="access-denied" style="display: none;">
            <h2>Access Denied</h2>
            <p>You don't have permission to create clubs.</p>
            <p>Please contact the administrator if you believe this is an error.</p>
            <a href="/index.html" class="btn btn-primary">Go to Home</a>
        </div>

        <!-- Create form -->
        <div id="create-form-container" style="display: none;">
            <form id="create-form" class="create-form">
                <!-- Club name with duplicate check -->
                <div class="form-group">
                    <label for="club-name">Club Name</label>
                    <div class="club-autocomplete">
                        <input type="text" id="club-name" placeholder="Enter club name (e.g. FC Barcelona)" autocomplete="off" required>
                        <ul id="suggestions-list" class="suggestions-list"></ul>
                    </div>
                    <small>Start typing to check if the club already exists</small>
                </div>

                <!-- Country code -->
                <div class="form-group">
                    <label for="country-code">Country Code (3 letters)</label>
                    <div class="club-autocomplete">
                        <input type="text" id="country-code" class="country-code-input" placeholder="ESP" maxlength="3" autocomplete="off" required>
                        <ul id="country-suggestions-list" class="suggestions-list"></ul>
                    </div>
                    <small>ISO 3166-1 alpha-3 code (e.g. ESP, ITA, DEU, GBR)</small>
                </div>

                <!-- Auto-enrichment toggle -->
                <div class="enrichment-toggle">
                    <input type="checkbox" id="auto-enrich" checked>
                    <label for="auto-enrich">Auto-fill city, hashtags, and website using AI</label>
                    <small>Uses OpenAI</small>
                </div>

                <!-- Optional: Manual fields (shown if auto-enrich is off) -->
                <div id="manual-fields" style="display: none;">
                    <div class="form-group">
                        <label for="club-city">City, Country</label>
                        <input type="text" id="club-city" placeholder="Barcelona, Spain">
                    </div>

                    <div class="form-group">
                        <label for="club-media">Hashtags</label>
                        <textarea id="club-media" placeholder="#fcbarcelona #viscabarca #campnou"></textarea>
                        <small>Relevant hashtags separated by spaces</small>
                    </div>

                    <div class="form-group">
                        <label for="club-web">Website URL</label>
                        <input type="url" id="club-web" placeholder="https://en.wikipedia.org/wiki/FC_Barcelona">
                        <small>Wikipedia page or official website</small>
                    </div>
                </div>

                <!-- Submit button -->
                <button type="submit" id="submit-btn" class="btn btn-primary submit-btn" disabled>
                    Create Club
                </button>

                <!-- Progress log -->
                <div id="progress-log" class="progress-log" style="display: none;"></div>

                <!-- Status message -->
                <div id="status-message" class="status-message" style="display: none;"></div>

                <!-- Result card -->
                <div id="result-card" class="result-card" style="display: none;">
                    <h3>Club Created Successfully</h3>
                    <div id="result-details"></div>
                    <div class="result-actions">
                        <a id="view-club-btn" href="#" class="btn btn-primary">View Club Page</a>
                        <button type="button" id="create-another-btn" class="btn btn-secondary">Create Another</button>
                        <a href="/upload.html" class="btn btn-secondary">Upload Sticker</a>
                    </div>
                </div>
            </form>
        </div>
    </main>

    <footer class="app-footer">
        <p>
            <a href="/about.html">About</a> |
            <a href="/catalogue.html">Catalogue</a> |
            <a href="/quiz.html">Quiz</a>
        </p>
        <p>StickerHunt &copy; 2025</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="shared.js?v=2"></script>
    <script src="club-create.js?v=2"></script>
</body>
</html>
