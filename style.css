/* style.css */

/* ------------------------------ */
/* Variables & Basic Reset        */
/* ------------------------------ */
:root {
    --font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    --color-text: #212121; /* Almost Black */
    --color-background: #FFFFFF; /* White */
    --color-accent: #FFC107; /* Yellow */
    --color-accent-darker: #FFA000; /* Darker Yellow for hover/active */
    --color-accent-text: #212121; /* Text on Yellow */
    --color-secondary-bg: #f8f9fa; /* Light Gray BG for some elements */
    --color-secondary-bg-hover: #e9ecef; /* Slightly darker gray for hover */
    --color-border: #E0E0E0; /* Light Gray Border */
    --color-disabled-bg: #E0E0E0;
    --color-disabled-text: #9E9E9E; /* Medium Gray */
    --color-success: #28a745; /* Green */
    --color-error: #dc3545; /* Red */
    --color-error-bg: #f8d7da;
    --color-info-text: #555; /* Slightly muted color for timer/score labels */
    --color-rank: #757575; /* Color for rank numbers */
    --color-link: #007bff; /* Standard link color */
    --color-link-hover: #0056b3;


    --border-radius: 8px;
    --container-width: 800px;
    --spacing-unit: 8px; /* Base for margins/paddings */
    --header-height: 60px; /* Define header height */
}

/* ... (Reset styles - unchanged) ... */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: var(--font-family); line-height: 1.6; background-color: var(--color-background); color: var(--color-text); padding: 0 var(--spacing-unit); }
h2 { color: var(--color-text); margin-bottom: calc(var(--spacing-unit) * 3); font-weight: 600; text-align: center; }
h2 { font-weight: 500; margin-bottom: calc(var(--spacing-unit) * 2); }
p { margin-bottom: calc(var(--spacing-unit) * 2); }
ol, ul { list-style: none; }
img { max-width: 100%; display: block; }
button { font-family: inherit; cursor: pointer; background: none; border: none; padding: 0; } /* Reset button defaults */
input[type="text"] { font-family: inherit; padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5); border: 1px solid var(--color-border); border-radius: var(--border-radius); font-size: 1em; margin-right: var(--spacing-unit); }

/* ------------------------------ */
/* Layout & Container             */
/* ------------------------------ */
.container { max-width: var(--container-width); margin: calc(var(--spacing-unit) * 4) auto; padding: 0 calc(var(--spacing-unit) * 2); text-align: center; }

.app-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 calc(var(--spacing-unit) * 2);
    height: var(--header-height);
    max-width: calc(var(--container-width) + 4 * var(--spacing-unit));
    margin: 0 auto;
    margin-bottom: calc(var(--spacing-unit) * 3);
    position: relative;
}

.logo-container { height: 100%; display: flex; align-items: center; }
#app-logo { height: calc(var(--header-height) * 0.65); width: auto; max-height: 40px; }

/* ------------------------------ */
/* Buttons                        */
/* ------------------------------ */
.btn { display: inline-block; padding: calc(var(--spacing-unit) * 1.25) calc(var(--spacing-unit) * 2.5); font-size: 1em; font-weight: 500; border: 1px solid transparent; border-radius: var(--border-radius); text-align: center; text-decoration: none; transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease; margin: calc(var(--spacing-unit)/2); vertical-align: middle; cursor: pointer; }
.btn-primary { background-color: var(--color-accent); color: var(--color-accent-text); border-color: var(--color-accent); box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); }
.btn-secondary { background-color: var(--color-background); color: var(--color-text); border: 1px solid var(--color-border); }
.btn-small { padding: calc(var(--spacing-unit) * 0.75) calc(var(--spacing-unit) * 1.5); font-size: 0.9em; }
.btn-large { padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 3); font-size: 1.1em; }
.btn-icon { background: none; border: none; padding: 0 calc(var(--spacing-unit) * 0.5); font-size: 1.1em; vertical-align: middle; margin-left: var(--spacing-unit); color: var(--color-text); opacity: 0.7; cursor: pointer; }
.btn-filter { padding: calc(var(--spacing-unit) * 0.5) calc(var(--spacing-unit) * 1.5); font-size: 0.9em; background-color: transparent; color: var(--color-text); border: 1px solid transparent; margin: 0 calc(var(--spacing-unit) * 0.5); opacity: 0.8; cursor: pointer; border-radius: var(--border-radius);} /* Add radius */
.btn-filter.active { font-weight: 600; background-color: var(--color-accent); color: var(--color-accent-text); opacity: 1; }
button:disabled, .btn:disabled { cursor: not-allowed !important; background-color: var(--color-disabled-bg) !important; color: var(--color-disabled-text) !important; border-color: var(--color-disabled-bg) !important; box-shadow: none !important; opacity: 1 !important; }
.btn-filter:disabled { background-color: var(--color-accent) !important; color: var(--color-accent-text) !important; opacity: 0.7 !important; cursor: not-allowed !important; } /* Ensure filter disabled is clear */

/* --- Link Style Button (for Logout) --- */
.btn-link {
    background: none;
    border: none;
    color: var(--color-link);
    text-decoration: none;
    padding: calc(var(--spacing-unit) * 0.75) var(--spacing-unit); /* Add some padding */
    font-size: 0.9em; /* Match small buttons */
    font-weight: 500;
    vertical-align: middle;
    cursor: pointer;
}

.button-group { display: flex; flex-wrap: wrap; justify-content: center; gap: calc(var(--spacing-unit) * 1.5); margin-top: calc(var(--spacing-unit) * 2); }

/* ------------------------------ */
/* Authentication Section         */
/* ------------------------------ */
#auth-section { font-size: 0.9em; text-align: right; display: flex; align-items: center; gap: var(--spacing-unit); flex-wrap: wrap; /* Allow wrapping if needed */ }
#user-status { display: flex; align-items: center; gap: var(--spacing-unit); flex-wrap: nowrap; /* Try to keep on one line */ }
#user-status strong { font-weight: 600; cursor: pointer; text-decoration: underline dotted; display: inline-block; /* Needed for potential ellipsis */ white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 150px; /* Adjust max-width as needed */ vertical-align: middle; }
#edit-nickname-form { display: none; position: absolute; right: calc(var(--spacing-unit) * 2); top: calc(var(--header-height) + var(--spacing-unit)); background-color: var(--color-background); padding: calc(var(--spacing-unit) * 2); border: 1px solid var(--color-border); border-radius: var(--border-radius); box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 10; min-width: 300px; text-align: left; }
#edit-nickname-form input { margin-bottom: var(--spacing-unit); display: block; width: 100%; }
#edit-nickname-form button { margin-top: var(--spacing-unit); margin-right: var(--spacing-unit); }

/* ... (Difficulty Selection - unchanged) ... */
#difficulty-selection .button-group .btn { min-width: 120px; background-color: var(--color-background); border: 1px solid var(--color-border); color: var(--color-text); }

/* ------------------------------ */
/* Game Area                      */
/* ------------------------------ */
#game-area { margin-top: calc(var(--spacing-unit) * 3); }
#sticker-container { aspect-ratio: 1 / 1; width: 60%; max-width: 300px; min-width: 150px; margin: 0 auto calc(var(--spacing-unit) * 4) auto; background-color: var(--color-secondary-bg); border: 1px solid var(--color-border); border-radius: var(--border-radius); overflow: hidden; display: flex; align-items: center; justify-content: center; }
#sticker-image { width: 100%; height: 100%; object-fit: contain; }
#sticker-image[alt*="Loading"], #sticker-image[alt*="Error"] { width: 50px; height: 50px; }

.options-group { display: grid; grid-template-columns: repeat(2, 1fr); gap: calc(var(--spacing-unit) * 1.5); max-width: 600px; margin: 0 auto; }
.options-group button { width: 100%; margin: 0; background-color: var(--color-background); border: 1px solid var(--color-border); color: var(--color-text); font-weight: 400; padding: calc(var(--spacing-unit) * 1.5) var(--spacing-unit); }
.options-group button.correct-answer { background-color: var(--color-success) ; border-color: var(--color-success) ; color: white ; font-weight: 600; }
.options-group button.incorrect-answer { background-color: var(--color-error) ; border-color: var(--color-error) ; color: white ; opacity: 0.7; }

.game-info { display: flex; justify-content: space-around; align-items: center; margin-top: calc(var(--spacing-unit) * 4); max-width: 400px; margin-left: auto; margin-right: auto; gap: calc(var(--spacing-unit) * 3); }
#timer, #score { font-size: 1.2em; color: var(--color-info-text); font-weight: 500; background-color: var(--color-secondary-bg); padding: var(--spacing-unit) calc(var(--spacing-unit) * 2); border-radius: var(--border-radius); border: 1px solid var(--color-border); }
#time-left { display: inline-block; min-width: 2ch; text-align: right; font-weight: 700; font-size: 1.3em; color: var(--color-text); margin-left: var(--spacing-unit); vertical-align: baseline; }
#current-score { display: inline-block; font-weight: 700; font-size: 1.3em; color: var(--color-text); margin-left: var(--spacing-unit); vertical-align: baseline; }
@keyframes score-bump { 0% { transform: scale(1); color: var(--color-text); } 50% { transform: scale(1.3); color: var(--color-accent-darker); } 100% { transform: scale(1); color: var(--color-text); } }
#score.score-updated { animation: score-bump 0.4s ease-out; }

/* ... (Result Area - unchanged styles, only HTML classes modified) ... */
#result-area { margin-top: calc(var(--spacing-unit) * 4); padding: calc(var(--spacing-unit) * 3) calc(var(--spacing-unit) * 2); }
#result-area h2 { font-size: 2.5em; font-weight: 700; color: var(--color-text); margin-bottom: var(--spacing-unit); }
#result-area .final-score-container { font-size: 1.8em; font-weight: 500; color: var(--color-info-text); margin-bottom: calc(var(--spacing-unit) * 4); }
#result-area #final-score { font-size: 2.2em; font-weight: 700; color: var(--color-accent-darker); display: inline-block; margin-left: var(--spacing-unit); }
#result-area .save-message { font-size: 0.9em; font-style: italic; color: var(--color-success); margin-top: calc(var(--spacing-unit) * -2); margin-bottom: calc(var(--spacing-unit) * 3); }
#result-area #play-again { margin-top: calc(var(--spacing-unit) * 2); }

/* ... (Leaderboard - unchanged styles, only JS logic modified) ... */
#leaderboard-section { margin-top: calc(var(--spacing-unit) * 4); padding-top: calc(var(--spacing-unit) * 3); }
#leaderboard-filters { margin-bottom: calc(var(--spacing-unit) * 3); display: flex; flex-direction: column; align-items: center; gap: calc(var(--spacing-unit) * 1.5); }
.filter-group { display: flex; align-items: center; flex-wrap: wrap; justify-content: center; }
.filter-group strong { margin-right: var(--spacing-unit); font-weight: 500; }
#leaderboard-list { max-width: 500px; margin: 0 auto calc(var(--spacing-unit) * 3) auto; text-align: left; counter-reset: leaderboard-counter; border: 1px solid var(--color-border); border-radius: var(--border-radius); overflow: hidden; }
#leaderboard-list li { padding: calc(var(--spacing-unit) * 1.5) var(--spacing-unit); border-bottom: 1px solid var(--color-border); counter-increment: leaderboard-counter; display: flex; gap: var(--spacing-unit); transition: background-color 0.2s ease; }
#leaderboard-list li:last-child { border-bottom: none; }
#leaderboard-list li::before { content: counter(leaderboard-counter) ". "; font-weight: 600; color: var(--color-accent-darker); min-width: 2.5em; text-align: right; }
#leaderboard-list li.user-score { font-weight: 700; background-color: color-mix(in srgb, var(--color-accent) 15%, transparent); }

/* ... (Indicators - unchanged) ... */
#loading-indicator { font-style: italic; color: var(--color-disabled-text); padding: var(--spacing-unit) 0; }
#error-message { color: var(--color-error); background-color: var(--color-error-bg); padding: var(--spacing-unit) calc(var(--spacing-unit) * 2); border-radius: var(--border-radius); margin-top: calc(var(--spacing-unit) * 2); border: 1px solid var(--color-error); display: inline-block; }

/* --- Disable hover effects for non-hover devices --- */
@media (hover: hover) {
    .btn-primary:hover:not(:disabled) { background-color: var(--color-accent-darker); border-color: var(--color-accent-darker); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); }
    .btn-secondary:hover:not(:disabled) { background-color: var(--color-secondary-bg-hover); }
    .btn-link:hover { color: var(--color-link-hover); text-decoration: underline; }
    .btn-icon:hover:not(:disabled) { opacity: 1; }
    .btn-filter:hover:not(:disabled) { background-color: var(--color-secondary-bg-hover); opacity: 1; }
    #difficulty-selection .button-group .btn:hover:not(:disabled) { background-color: var(--color-accent); border-color: var(--color-accent); color: var(--color-accent-text); }
    .options-group button:hover:not(:disabled) { background-color: var(--color-accent); border-color: var(--color-accent); color: var(--color-accent-text); }
    #leaderboard-list li:hover { background-color: var(--color-secondary-bg-hover); }
}

/* ------------------------------ */
/* Responsiveness                 */
/* ------------------------------ */
@media (max-width: 768px) {
    .app-header {
        /* Keep header flex row */
        height: auto; /* Allow height to adjust for wrapping */
        padding: var(--spacing-unit); /* Reduce padding */
        flex-wrap: wrap; /* Allow wrapping if needed */
        justify-content: space-between; /* Keep space-between */
    }
     #auth-section {
        /* Remove width: 100% to allow shrinking */
        justify-content: flex-end; /* Align to right */
     }
     #user-status {
        /* Remove width: 100% */
        justify-content: flex-end;
     }
     #user-status strong { max-width: 100px; } /* Further reduce max-width for nickname */
     #user-status .btn-small, #user-status .btn-link { margin: 2px; font-size: 0.85em; padding: 4px 8px; } /* Smaller buttons/link */
     .logo-container { flex-shrink: 0; } /* Prevent logo from shrinking too much */

    #edit-nickname-form { position: static; width: 100%; margin-top: var(--spacing-unit); box-shadow: none; border: 1px solid var(--color-border); background-color: var(--color-secondary-bg); }
}
@media (max-width: 700px) {
    .options-group { max-width: 90%; }
    /* Make game area elements smaller to fit */
    #sticker-container { width: 70%; max-width: 220px; margin-bottom: calc(var(--spacing-unit) * 2); }
    .options-group { gap: var(--spacing-unit); }
    .options-group button { padding: var(--spacing-unit); font-size: 0.9em;}
    .game-info { margin-top: calc(var(--spacing-unit) * 2); }
    #timer, #score { font-size: 1em; padding: calc(var(--spacing-unit)*0.75) var(--spacing-unit); }
    #time-left, #current-score { font-size: 1.1em; }
}

@media (max-width: 600px) {
    body { padding: 0; }
    .container { padding: 0 var(--spacing-unit); margin-top: calc(var(--spacing-unit) * 2); margin-bottom: calc(var(--spacing-unit) * 2); }
    /* Further mobile adjustments if needed */
    .options-group { grid-template-columns: 1fr; } /* Force single column */
    .game-info { flex-direction: row; /* Keep side-by-side */ justify-content: space-around; gap: var(--spacing-unit); }
    /* Result Screen on Mobile */
     #result-area h2 { font-size: 2em; }
     #result-area .final-score-container { font-size: 1.5em; }
     #result-area #final-score { font-size: 1.8em; }
     #result-area #play-again { font-size: 1em; padding: calc(var(--spacing-unit) * 1.25) calc(var(--spacing-unit) * 2.5); }
    /* Leaderboard on Mobile */
    #leaderboard-filters { gap: var(--spacing-unit); }
    .filter-group { gap: calc(var(--spacing-unit) * 0.5); font-size: 0.9em; }
    .filter-group strong { display: block; width: 100%; margin-bottom: 5px; text-align: center; }
    .btn-filter { margin: 2px; }
    #leaderboard-list { max-width: 100%; padding: 0; }
    #leaderboard-list li { font-size: 0.9em; padding: var(--spacing-unit); }
    #leaderboard-list li::before { min-width: 2em; }
}
